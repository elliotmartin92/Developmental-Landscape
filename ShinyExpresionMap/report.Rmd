---
title: "Ovary App Report"
output:
html_document:
fig_caption: yes
header-includes:
  \usepackage{float}
  \let\origfigure\figure
  \let\endorigfigure\endfigure
  \renewenvironment{figure}[1][2] {
  \expandafter\origfigure\expandafter[H]
  } {
  \endorigfigure
  }
params:
  n: NA
---

```{r setup, echo=FALSE, include=FALSE}
library(knitr)
library(gginnards)
library(captioner)

if (pages_to_report == "DevProg" || pages_to_report == "all") {
  distPlot_to_display = TRUE
}else{distPlot_to_display = FALSE}

if (pages_to_report == "heatmap" || pages_to_report == "all") {
  heatmap_to_display = TRUE
}else{heatmap_to_display = FALSE}

if (pages_to_report == "violin" || pages_to_report == "all") {
  violin_to_display = TRUE
}else{violin_to_display = FALSE}

fig_nums = captioner()

if (input$violin_normalization_option == "each_gene") {
  normaliztion_text = " normalized to expression in UAS-tkv "
}else if (input$violin_normalization_option == "unNorm") {
  normaliztion_text = " "
}

if(input$SeqDataset == "Input_seq"){
  fig_nums("ovary_map", paste("Plot of", input$variable,"TPM+ over development."))
  fig_nums("heat_map", "Heatmap of log~2~(TPM+1) of input mRNA expression over development.")
  if (input$violin_geneList_option == "GO_term_selection") {
    fig_nums("violin_plot", paste0("Plot of genes in the GO-term \"", input$GO_term,"\" over development representing log~2~(TPM+1)", normaliztion_text ,"of input mRNA"))
  }else if(input$violin_geneList_option == "Custom_selection"){
    fig_nums("violin_plot", paste0("Plot of log~2~(TPM+1)", normaliztion_text, "of a custom gene group over development of input mRNA expression"))
  }
}else if (input$SeqDataset == "Polysome_seq") {
  fig_nums("ovary_map", paste("Plot of", input$variable,"log~2~(TE) over development."))
  fig_nums("heat_map", "Heatmap of log~2~(TE) over development.")
  if (input$violin_geneList_option == "GO_term_selection") {
    fig_nums("violin_plot", paste0("Plot of log~2~(TE)", normaliztion_text, "of genes in the GO-term \"", input$GO_term, "\" over development."))
  }else if(input$violin_geneList_option == "Custom_selection"){
    fig_nums("violin_plot", paste0("Plot of log~2~(TE)", normaliztion_text, "of a custom gene group over development."))
  }
}else if (input$SeqDataset == "Single_cell_seq") {
  if (input$violin_normalization_option == "each_gene") {
    normaliztion_text = " normalized to expression in GSC/CB/2CC "
  }else if (input$violin_normalization_option == "unNorm") {
    normaliztion_text = " "
  }
  fig_nums("ovary_map", paste("Plot of", input$variable,"CPM over development."))
  fig_nums("heat_map", "Heatmap of log~2~(CPM+1) of input mRNA expression over development.")
  if (input$violin_geneList_option == "GO_term_selection") {
    fig_nums("violin_plot", paste0("Plot of genes in the GO-term \"", input$GO_term,"\" over development representing log~2~(CPM+1)", normaliztion_text ,"of mRNA"))
  }else if(input$violin_geneList_option == "Custom_selection"){
    fig_nums("violin_plot", paste0("Plot of log~2~(CPM+1)", normaliztion_text, "of a custom gene group over development of mRNA expression"))
  }
}
```
<br><br>

```{r, echo=FALSE, fig.height = 0.5, fig.width = 8.5, fig.align = "center", eval=distPlot_to_display}
  ovary_map_legend
```

```{r, echo=FALSE, fig.height = 5, fig.width= 14, fig.align = "center", eval=distPlot_to_display, fig.cap=fig_nums("ovary_map")}
  ovary_map_plot
```
`r if(distPlot_to_display){"<br><br><br><br>"}`

```{r, echo=FALSE, fig.height = 6, fig.width= 12, fig.align = "center", eval=heatmap_to_display, fig.cap=fig_nums("heat_map")}
  heat_map_global
```
<br><br><br><br>
```{r, echo=FALSE, fig.height = 4, fig.width= 12, fig.align = "center", eval=violin_to_display, fig.cap=fig_nums("violin_plot")}
  gene_violin_plot_global
```

